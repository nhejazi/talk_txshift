\documentclass[12pt,t]{beamer}
\usepackage{graphicx}
\setbeameroption{hide notes}
\setbeamertemplate{note page}[plain]
\usepackage{listings}
\usepackage{datetime}
\usepackage{url}

% specifications for presenter mode
%\beamerdefaultoverlayspecification{<+->}
%\setbeamercovered{transparent}

\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}

\usepackage{amstext}
%\usepackage{coloremoji}

\usepackage{graphicx}
\graphicspath{ {Figs/} }

% math shorthand
\usepackage{bm}
\usepackage{amsmath}
\usepackage{mathtools}
\newcommand{\D}{\mathcal{D}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\X}{\mathcal{X}}
\newcommand{\lik}{\mathcal{L}}
\DeclarePairedDelimiterX{\infdivx}[2]{(}{)}{%
  #1\;\delimsize\|\;#2%
}
\newcommand{\infdiv}{D\infdivx}
\DeclarePairedDelimiter{\norm}{\lVert}{\rVert}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

% Bibliography
\usepackage{natbib}
\bibpunct{(}{)}{,}{a}{}{;}
\usepackage{bibentry}
\nobibliography*

\input{header.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% end of header
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% title info
\title{\normalsize Robust Nonparametric Inference for Stochastic Interventions
  Under Multi-Stage Sampling}
\subtitle{\scriptsize for the UC Berkeley Biostatistics Seminar Series,\\ given
                      02 April 2018 \\[-10pt]
         }
\author{\href{https://nimahejazi.org}{Nima Hejazi}
       \\[-10pt]
       }
\institute{Group in Biostatistics \\
           University of California, Berkeley \\
           \href{https://www.stat.berkeley.edu/~nhejazi}
             {\tt \scriptsize \color{foreground}
               stat.berkeley.edu/\textasciitilde{}nhejazi
             }
           \\[4pt]
           \includegraphics[height=20mm]{Figs/seal-berkeley.png}
           \\[-12pt]
          }
\date{
  \href{https://nimahejazi.org}
      {\tt \scriptsize \color{foreground} nimahejazi.org}
  \\[-4pt]
  \href{https://twitter.com/nshejazi}
      {\tt \scriptsize \color{foreground} twitter/@nshejazi}
  \\[-4pt]
  \href{https://github.com/nhejazi}
      {\tt \scriptsize \color{foreground} github/nhejazi}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

% title slide
{
\setbeamertemplate{footline}{} % no page number here
\frame{
  \titlepage

  \vspace{-1em}

  \centerline{\href{https://goo.gl/Vq6v5o}{\tt \scriptsize
                                           \underline{slides}: goo.gl/Vq6v5o}}
  \vspace{-1.5em}
  \vfill \hfill \includegraphics[height=6mm]{Figs/cc-zero.png} \vspace*{-0.5cm}

  \note{This slide deck is for a seminar-length talk (about 50 minutes) on a new
    approach to causal inference and nonparametric variable importance in the
    context of parameters defined as treatment shifts. Here, we introduce an
    additive treatment shift parameter, extensions for censored data (including
    a multiple double robustness property), new statistical software for
    applying our approach, and applications to a vaccine efficacy trial
    examining HIV. This talk was most recently given at a meeting of the
    Biostatistics Seminar Series at the University of California, Berkeley.

    Source: {\tt https://github.com/nhejazi/talk\_txshift} \\
    Slides: {\tt https://goo.gl/LAoDUJ} \\
    With notes: {\tt https://goo.gl/Vq6v5o}
}
}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Preview: Summary}
\only<1>{\addtocounter{framenumber}{-1}}

\begin{center}
\begin{itemize}
  \itemsep10pt
  \item ...
  \item ...
  \item ...
  \item ...
\end{itemize}
\end{center}

\note{We'll go over this summary again at the end of the talk. Hopefully, it
  will all make more sense then.
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Motivation: Let's meet the data}

\begin{center}
\begin{itemize}
  \itemsep10pt
  \item HIV Vaccine Trials Network (HVTN) 505 HIV-1 vaccine efficacy trial.
  \item 2504 participants, with all observed cases matched to controls after
    collection of endpoints of interest.
  \item Background quantities ($W$): sex, age, BMI, etc.
  \item Variables of interest ($A$): biomarkers of immune response (e.g., T-Cell
    response).
  \item Outcome of interest ($Y$): HIV-1 infection risk.
  \item \textbf{Question}: How would changes in the immune response profile
    impact risk of HIV-1 infection?
\end{itemize}
\end{center}

\note{
\begin{itemize}
  \itemsep10pt
  \item A vaccine effective at preventing HIV-1 acquisition would be a
    cost-effective and durable approach to halting the worldwide epidemic.
  \item Identifying vaccine-induced immune-response biomarkers that predict a
    vaccine's ability to protect individuals from HIV-1 infection is a high
    priority.
  \item The study was halted on 22 April 2013 due to absence of vaccine
    efficcacy. There was no significant effect of the vaccine on the primary
    infection end- point of HIV-1 infection between week 28 and month 24.
\end{itemize}
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Preventive Vaccines for HIV}

\begin{center}
\begin{itemize}
  \itemsep10pt
  \item Substantial heterogeneity is present in the genetic characteristics of
    HIV.
  \item Preventive HIV vaccines constructed using only several antigens (out of
    a great many).
  \item \textbf{Success:} Protect well against infection caused by virus strains
    \textit{similar} to the source strain.
  \item \textbf{Failure:} Don't protect against disease caused by strains
    antigenically \textit{dissimilar} to source strain.
\end{itemize}
\end{center}

\note{
\begin{itemize}
  \itemsep10pt
  \item HIV is a high-impact public health issue but numerous attempts to
    develop vaccines have met with only mild success.
  \item The complexity of the disease mechanism makes it quite challenging to
    study the numerous factors that contribute to a possible mitigation of
    infection risk.
\end{itemize}
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Sieve Analysis: A Brief History}

\begin{center}
\begin{itemize}
  \itemsep10pt
  \item The study of whether and how the efficacy of a vaccine varies with the
    virus' characteristics.
  \item Why ``sieve''? Vaccine as a barrier against select strains, but
    dissimilar strains break through.
  \item Identification of sieve effects guides decisions for future development
    of multivalent vaccines.
  \item Sieve analysis is usually performed within a \textit{competing risks}
    framework.
\end{itemize}
\end{center}

\note{
\begin{itemize}
  \itemsep10pt
  \item The reliance on competing risks leads to the use of nonparametric
    estimators like Aalen-Johnson or semiparametric methods like the Cox model.
  \item Within this framework, could evaluate instantaneous risks of infection
    (i.e., hazard) or cumulative incidence. The latter could be more interesting
    from a public health perspective.
\end{itemize}
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Immune Response and Vaccine Efficacy}
\begin{center}
\begin{itemize}
  \itemsep10pt
  \item A 12-color intracellular cytokine staining (ICS) assay was performed.
  \item Cryopreserved peripheral blood mononuclear cells were stimulated with
    synthetic HIV-1 peptide pools.
  \item Immune responses of interest were
    \begin{enumerate}
      \item Total magnitude of the $\text{CD4}^+$ T-cell response.
      \item COMPASS Env-specific $\text{CD4}^+$ T-cell polyfunctionality score.
      \item Total magnitude of the $\text{CD8}^+$ T-cell response.
      \item COMPASS Env-specific $\text{CD8}^+$ T-cell polyfunctionality score.
      \item $\text{CD4}^+$ and $\text{CD8}^+$ T-cell
        $\text{log}_{10}$-transformed total magnitude variables.
    \end{enumerate}
\end{itemize}
\end{center}

\note{
\begin{itemize}
  \itemsep10pt
  \item For a complete description of the immune responses of interests and how
    these were collected, consult the supplemental materials of HE Janes (2017).
  \item This class of data is difficult and expensive to collect, which begins
    to provide motivation for why it might be undesirable to restrict the types
    of analyses performed to classical semiparametrics.
  \item Such classical analyses severely restrict the scope of the scientific
    questions we're able to ask.
\end{itemize}
}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Immune Reponse and Vaccine Efficacy}
\begin{center}
\begin{itemize}
  \itemsep10pt
  \item \textit{Goal:} Evaluate the immune response variables among vaccine
    recipients as predictors of HIV-1 infection.
  \item Cox proportional hazard models that account for case-control sampling
    design and adjust for the baseline covariates.
  \item $\lambda \left(t; Z = z \right) = \lambda_0(t) \exp\left(\beta^Tz
    \right), \quad t\geq 0$.
    \begin{itemize}
      \item Semiparametric overall.
      \item nonparametric in $\lambda_0$, parametric in $\beta$.
    \end{itemize}
  \item Corrections for multiple testing performed, with q-values below $0.20$
    considered significant.
\end{itemize}
\end{center}

\note{
  \begin{itemize}
    \item Principal components analysis (PCA) was used to discover unique immune
      response profiles among vaccine recipients.
    \item First and second principal components were associated with HIV-1
      infection using Cox proportional hazards regression models that account
      for the sampling design and baseline covariates.
    \item Logistic regression models with lasso penalty and weights to account
      for case-control sampling were used to identify the baseline covariates
      and immune response variables that best predict HIV-1 infection.
  \end{itemize}
}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Motivation: Science Before Statistics}
\begin{center}
\begin{itemize}
  \itemsep10pt
  \item Cox model: assumption of proportional hazards.
  \item Such models are a matter of convenience: does $\hat{\beta}$ answer our
    scientific questions?
    \begin{itemize}
      \item Perhaps not.
    \end{itemize}
  \item Is consideration being given to whether the data could have been
    generated by a process that is consistent with the assumptions of the Cox
    model?
    \begin{itemize}
      \item Perhaps not.
    \end{itemize}
\end{itemize}
\end{center}

\note{
}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Data analysis? A Data-Adaptive Approach}

\begin{center}
\begin{enumerate}
  \itemsep8pt
  \item Isolate a subset of CpG sites for which there is cursory evidence of
    differential methylation.
  \item Assign CpG sites into neighborhoods (e.g., bp distance). If there are
    many neighbors, apply clustering (e.g., \textit{PAM}) to select a subset.
  \item Estimate \textit{variable importance measure} (VIM) at each screened CpG
    site, with disease as intervention ($A$) and controlling for neighboring CpG
    sites ($W$).
  \item Apply a variant of the Benjamini \& Hochberg method for FDR control,
    accounting for initial screening.
\end{enumerate}
\end{center}

\note{
\begin{itemize}
  \itemsep10pt
  \item Pre-screening is a critical step since we cannot perform computationally
    intensive estimation on all the sites. This is flexible --- just use your
    favorite method (as long as allows a ranking to be made).
  \item The variable importance step merely comes down to the creation of a
    score. We use TMLE to statistically estimate parameters from causal models.
    The procedure is general enough to accomodate any inference technique.
\end{itemize}
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Pre-Screening --- Pick Your Favorite Method}

\begin{center}
\begin{itemize}
  \itemsep10pt
  \item The estimation procedure is computationally intensive --- apply it only
    to sites that appear promising.
  \item Consider estimating univariate (linear) regressions of intervention on
    CpG methylation status. Fast, easy.
  \item Select CpG sites with a marginal p-value below, say, $0.01$. Apply
    data-adaptive procedure to this subset.
  \item The modeling assumptions do not matter since the we won't be pursuing
    inference under such a model.
  \item Software implementation is extensible. Users are encouraged to add their
    own. (It's easy!)
\end{itemize}
\end{center}

\note{
\begin{itemize}
  \itemsep10pt
  \item We'll be adding to the available routines for pre-screening too! For
    now, we have \textsc{limma}, and more are on the way.
\end{itemize}
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Too Many Neighbors? Clustering}

\begin{center}
\begin{itemize}
  \itemsep10pt
  \item There are many options: $k$-means, $k$-medoids, etc., as well as many
    algorithmic solutions.
  \item For convenience, we use \underline{P}artitioning \underline{A}round
    \underline{M}edoids (PAM), a well-established algorithm.
  \item With limited sample sizes, the number of neighboring sites that may be
    controlled for is limited.
  \item To faithfully answer the question of interest, choose the neighboring
    sites that are the most representative.
  \item This is an \textit{optional} step --- it need only be applied when there
    is a large number of CpG sites in the neighborhood of the target CpG site.
\end{itemize}
\end{center}

\note{
\begin{itemize}
  \itemsep10pt
  \item The number of sites that we can control for is roughly a function of
    sample size. This impacts the definition of the parameter that we estimate,
    and allows enough flexibility to obtain either very local or more regional
    estimates.
\end{itemize}
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Nonparametric Variable Importance}

\begin{center}
\begin{itemize}
  \itemsep8pt
  \item Let's consider a simple target parameter: the average treatment effect
    (ATE):
    \[
      \Psi_g(P_0) = \mathbb{E}_{W,0}[\mathbb{E}_0[Y_g \mid A = 1, W_{-g}] -
      \mathbb{E}_0[Y_g \mid A = 0, W_{-g}]]
    \]
  \item Under certain (untestable) assumptions, interpretable as difference in
    methylation at site $g$ with intervention and, possibly contrary to
    fact, the same under no intervention, controlling for neighboring sites.
  \item Provides a \textit{nonparametric} (model-free) measure for those CpG
    sites impacted by a discrete intervention.
  \item Let the choice of parameter be determined by our scientific question of
    interest.
\end{itemize}
\end{center}

\note{
By allowing scientific questions to inform the parameters that we choose
to estimate, we can do a better job of actually answering the questions of
interest to our collaborators. Further, we abandon the need to specify the
functional relationship between our outcome and covariates; moreover, we
can now make use of advances in machine learning.
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Target Minimum Loss-Based Estimation}

\begin{center}
\begin{itemize}
  \itemsep8pt
  \item We use \textit{targeted minimum loss-based estimation} (TMLE), a method
    for inference in semiparametric infinite-dimensional statistical models.
  \item No need to specify a functional form or assume that we know the true
    data-generating distribution.
  \item \textbf{Asymptotic linearity:}
    \[
      \Psi_g(P_n^*) - \Psi_g(P_0) = \frac{1}{n} \sum_{i = 1}^{n} IC(O_i) +
      o_P\left(\frac{1}{\sqrt{n}}\right)
    \]
  \item \textbf{Limiting distribution:}
    \[
      \sqrt{n}(\Psi_n - \Psi) \to N(0, Var(D(P_0)))
    \]
  \item \textbf{Statistical inference:}
    \[
      \Psi_n \pm z_{\alpha} \cdot \frac{\sigma_n}{\sqrt{n}}
    \]
\end{itemize}
\end{center}

\note{
Under the additional condition that the remainder term $R(\hat{P}^*, P_0)$
decays as $o_P \left( \frac{1}{\sqrt{n}} \right),$ we have that
$\Psi_n - \Psi_0 = (P_n - P_0) \cdot D(P_0) + o_P
\left( \frac{1}{\sqrt{n}} \right),$ which, by a central limit theorem,
establishes a Gaussian limiting distribution for the estimator, with variance
$V(D(P_0))$, the variance of the efficient influence curve (canonical gradient)
when $\Psi$ admits an asymptotically linear representation.

The above implies that $\Psi_n$ is a $\sqrt{n}$-consistent estimator of $\Psi$,
that it is asymptotically normal (as given above), and that it is locally
efficient. This allows us to build Wald-type confidence intervals, where
$\sigma_n^2$ is an estimator of $V(D(P_0))$. The estimator $\sigma_n^2$
may be obtained using the bootstrap or computed directly via $ \sigma_n^2 =
\frac{1}{n} \sum_{i = 1}^{n} D^2(\bar{Q}_n^*, g_n)(O_i)$
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Corrections for Multiple Testing}

\begin{center}
\begin{itemize}
  \itemsep10pt
  \item Multiple testing corrections are critical. Without these, we
    systematically obtain misleading results.
  \item The Benjamini \& Hochberg procedure for controlling the False Discovery
    Rate (FDR) is a well-established technique for addressing the multiple
    testing issue.
  \item We use a modified BH-FDR procedure to account for the pre-screening step
    of the proposed algorithm.
  \item This modified BH-FDR procedure for multi-stage analyses (FDR-MSA) works
    by adding a p-value of $1.0$ for each site that did not pass pre-screening
    then performs BH-FDR as normal.
\end{itemize}
\end{center}

\note{
\begin{itemize}
  \itemsep10pt
  \item ...
  \item ...
  \item ...
\end{itemize}
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Software package: R/txshift}

%\begin{figure}[H]
  %\centering
  %\includegraphics[width=\textwidth]{methyvim_bioc}
  %\caption{
    %\url{https://github.com/nhejazi/txshift}
  %}
%\end{figure}

\begin{center}
\begin{itemize}
  \itemsep4pt
  \item Variable importance for continuous interventions.
  \item Take it for a test drive! Coming soon $\ldots$
\end{itemize}
\end{center}

\note{
\begin{itemize}
  \itemsep10pt
  \item Contribute on GitHub: \url{https://github.com/nhejazi/txshift}.
  \item Reach out to us with questions and any feature requests.
\end{itemize}
}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Review: Summary}

\begin{center}
\begin{itemize}
  \itemsep10pt
  \item ...
  \item ...
  \item ...
  \item ...
\end{itemize}
\end{center}

\note{It's always good to include a summary.}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% don't want dimming with references
\setbeamercovered{}
\beamerdefaultoverlayspecification{}

\begin{frame}[c,allowframebreaks]{References}

\bibliographystyle{apalike}
\nocite{*}
\bibliography{references}

%\note{Here's some work we've talked about. Go check these out if interested.}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Acknowledgments}

\vspace{20pt}

\underline{Collaborators:}

\begin{tabular}{@{}l@{\hspace{1.0cm}}l@{}}
  David C.~Benkeser & \footnotesize \lolit Emory University \\
  Mark J.~van der Laan & \footnotesize \lolit University of California,
    Berkeley \\
  Peter B.~Gilbert & \footnotesize \lolit Fred Hutchinson Cancer Research
    Center \\
  Holly E.~Janes & \footnotesize \lolit Fred Hutchinson Cancer Research
    Center \\
\end{tabular}

\vspace{10mm}

\underline{Funding source}:\\
UC Berkeley NIH BD2K Biomedical Big Data Training Program: T32-LM012417-02

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[c]{Thank you.}

\Large
Slides: \href{https://goo.gl/LAoDUJ}{goo.gl/LAoDUJ} \quad
\includegraphics[height=5mm]{Figs/cc-zero.png}

\vspace{3mm}
Notes: \href{https://goo.gl/Vq6v5o}{goo.gl/Vq6v5o}

%\vspace{3mm}
%Source (repo): \href{https://goo.gl/m5As73}{goo.gl/m5As73}

\vspace{3mm}
\href{https://www.stat.berkeley.edu/~nhejazi}{\tt
  stat.berkeley.edu/\textasciitilde{}nhejazi}

\vspace{3mm}
\href{https://nimahejazi.org}{\tt nimahejazi.org}

\vspace{3mm}
\href{https://twitter.com/nshejazi}{\tt twitter/@nshejazi}

\vspace{3mm}
\href{https://github.com/nhejazi}{\tt github/nhejazi}

%\note{Here's where you can find me, as well as the slides for this talk.}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}

